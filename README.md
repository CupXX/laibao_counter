# 打卡记录统计工具 - 云端版

基于Streamlit的网页端工具，支持多用户独立使用，可通过网址直接访问。每个用户拥有完全独立的数据空间，保护隐私安全。

## 🌟 核心特点

### 🔒 隐私保护
- **用户隔离**: 每个用户拥有完全独立的数据空间
- **会话管理**: 基于session ID的数据隔离机制  
- **数据安全**: 用户间数据完全不可见

### 📊 功能全面
- 📤 **批量上传**: 支持同时上传多个Excel文件
- 🔍 **智能识别**: 自动识别Excel中的昵称列和时间列
- 💰 **加权功能**: 支持为每个文件设置码数（积分倍数）
- 🏆 **奖励机制**: 支持前N名用户获得积分奖励倍数
- 🔄 **重复检测**: 自动跳过已处理的文件
- 📥 **数据导出**: 用户可下载自己的数据备份

### 🌐 云端部署
- **免费访问**: 部署在Streamlit Community Cloud
- **全球可用**: 任何地方都可以通过网址访问
- **24/7在线**: 无需安装，打开即用
- **自动清理**: 24小时后自动清理过期会话数据

## 🚀 立即使用

### 云端版本 (推荐)
直接访问网址，无需安装任何软件：
**[点击这里使用 →](https://您的应用链接.streamlit.app)**

### 本地部署
如果需要本地运行：

1. **安装依赖**
```bash
pip install -r requirements.txt
```

2. **运行应用**
```bash
streamlit run app.py
```

3. **访问应用**
浏览器打开 `http://localhost:8501`

## 📖 使用教程

### 步骤1：上传文件
1. 点击"📤 上传Excel文件"区域
2. 选择包含打卡记录的Excel文件（支持多选）
3. 系统会自动识别昵称列和时间列

### 步骤2：设置参数
1. 在文件列表中调整"码数"（积分倍数）
2. 在侧边栏设置奖励机制（可选）
   - 基础积分：每人每次参与的基础分数
   - 奖励人数：前几名获得奖励
   - 奖励倍数：奖励的积分倍数

### 步骤3：处理数据
1. 点击"🚀 开始处理"按钮
2. 查看处理结果和积分统计
3. 在排行榜中查看最终结果

### 步骤4：导出数据
1. 在侧边栏点击"📥 下载我的数据"
2. 保存JSON格式的数据备份

## 支持的文件格式

- Excel文件 (.xlsx, .xls)
- 文件大小：建议每个文件不超过10MB

## 支持的昵称列名

系统会自动识别以下列名：
- 中文：昵称、姓名、用户名、名字、微信昵称、群昵称、参与者、打卡人、用户昵称
- 英文：name、nickname、username

## 文件结构

```
laibao_counter/
├── app.py                 # 主应用文件
├── data_manager.py        # 数据管理模块
├── excel_processor.py     # Excel处理模块
├── requirements.txt       # 依赖包
├── data/
│   └── records.json      # 积分记录存储
└── README.md             # 说明文件
```

## 数据存储

- 积分记录保存在 `data/records.json` 文件中
- 支持手动备份功能
- 数据格式为JSON，便于后续处理

## 🔒 隐私政策

### 数据隔离保护
- **独立空间**: 每个用户拥有完全独立的数据存储空间
- **会话隔离**: 基于唯一session ID，确保用户间数据不会混淆
- **自动清理**: 超过24小时的会话数据会被自动删除
- **数据可控**: 用户可随时下载和删除自己的数据

### 云端存储说明
- 数据临时存储在Streamlit Cloud服务器
- 仅用于应用功能，不会被第三方访问
- 建议及时下载备份重要数据
- 不涉及个人敏感信息收集

## 🏗️ 技术架构

### 多用户设计
```
用户A ─── Session ID: abc123 ─── records_abc123.json
用户B ─── Session ID: def456 ─── records_def456.json  
用户C ─── Session ID: ghi789 ─── records_ghi789.json
```

### 核心组件
- **DataManager**: 多用户数据管理，支持会话隔离
- **ExcelProcessor**: Excel文件解析和数据提取
- **Session Management**: 自动会话创建和清理
- **Export System**: 用户数据导出和备份

## 📋 使用场景

- **群聊打卡**: 微信群、QQ群打卡记录统计
- **活动统计**: 不同活动参与度统计（支持权重设置）
- **学习管理**: 学习打卡、作业提交统计
- **竞赛积分**: 多轮比赛积分累计（支持不同码数）
- **团队管理**: 任何需要基于Excel统计参与度的场景

## ⚙️ 高级功能

### 奖励机制
- 支持基于提交时间的前N名奖励
- 可自定义奖励倍数和人数
- 自动识别时间列进行排序

### 积分计算
```
基础积分 = 基础分值 × 码数
奖励积分 = 基础积分 × 奖励倍数（仅前N名）
```

### 数据导出
- JSON格式完整数据导出
- 包含处理历史和积分详情
- 支持重新导入恢复数据

## 🚨 注意事项

### Excel文件要求
1. 支持 `.xlsx` 和 `.xls` 格式
2. 第2行必须是列名（第1行可以是标题）
3. 昵称列包含关键词：昵称、姓名、用户名等
4. 文件大小建议不超过10MB

### 使用建议
1. 及时下载备份重要数据
2. 码数设置范围：1-100
3. 相同文件名会被跳过重复处理
4. 建议在稳定网络环境下使用

## 🛠️ 故障排除

| 问题 | 解决方案 |
|------|----------|
| 无法识别昵称列 | 检查列名是否包含"昵称"、"姓名"等关键词 |
| 文件上传失败 | 确认文件格式和大小，检查网络连接 |
| 数据没有保存 | 检查浏览器是否禁用了cookies |
| 页面加载慢 | 清理浏览器缓存，刷新页面 |
